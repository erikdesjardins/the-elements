language: rust
rust: stable
branches:
  only:
    - master
    - /^v[0-9]/
cache:
  cargo: true
before_script:
  - rustup toolchain add nightly
  - rustup component add rustfmt-preview
  - rustup component add clippy-preview --toolchain=nightly
script:
  - cargo fmt --all -- --check
  - RUSTFLAGS="-D warnings" cargo +nightly clippy
  - cargo +nightly test
  - cargo +nightly build --release
  - strip target/release/the-elements
  - ls -lh target/release/the-elements
